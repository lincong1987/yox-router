!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):n.YoxRouter=e()}(this,function(){"use strict"
function n(n){return f.numeric(n)?n=+n:f.string(n)&&(n="true"===n?!0:"false"===n?!1:"null"===n?null:"undefined"===n?void 0:decodeURIComponent(n)),n}function e(n,e){var t=[n]
return f.string(e)?d.push(t,encodeURIComponent(e)):f.number(e)||f["boolean"](e)?d.push(t,""+e):null===e?d.push(t,"null"):void 0===e&&d.push(t,"undefined"),t.join(y)}function t(e){var t=void 0,o=void 0,i=void 0,r=void 0
return e&&d.each(e.split(_),function(e){if(o=e.split(y),i=v.trim(o[0]),r=o[1],i)if(t||(t={}),r=n(r),v.endsWith(i,H)){i=v.slice(i,0,-H.length)
var a=t[i]||(t[i]=[])
d.push(a,r)}else t[i]=r}),t}function o(n){var t=[]
return p.each(n,function(n,o){f.array(n)?d.each(n,function(n){n=e(o+H,n),n&&d.push(t,n)}):(n=e(o,n),n&&d.push(t,n))}),t.join(_)}function i(e,t){var o=void 0,i=e.split(g),r=t.split(g)
return i.length===r.length&&d.each(r,function(e,t){v.startsWith(e,O)&&(o||(o={}),o[e.slice(O.length)]=n(i[t]))}),o}function r(n,e){var t=void 0,o=e.split(g)
return p.each(n,function(n,e){var i=e.split(g)
return o.length===i.length&&(d.each(i,function(n,t){return v.startsWith(n,O)||n===o[t]?void 0:(e=null,!1)}),e)?(t=e,!1):void 0}),t}function a(n,e){var o=void 0,a=void 0,u=e.indexOf("?")
u>=0?(o=e.substring(0,u),a=e.slice(u+1)):o=e
var s={realpath:o},h=r(n,o)
return h&&(s.path=h,s.params=i(o,h),s.query=t(a)),s}function u(n,e,t){var i=[],r=""
return d.each(n.split(g),function(n){d.push(i,v.startsWith(n,O)?e[n.slice(O.length)]:n)}),i=i.join(g),t&&(t=o(t),t&&(r="?"+t)),R+i+r}var s=function(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")},h=function(){function n(n,e){for(var t=0;t<e.length;t++){var o=e[t]
o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(n,o.key,o)}}return function(e,t,o){return t&&n(e.prototype,t),o&&n(e,o),e}}(),c=void 0,f=void 0,l=void 0,d=void 0,p=void 0,v=void 0,E=void 0,m=void 0,R="#!",O=":",g="/",_="&",y="=",H="[]",T=function(){function n(){s(this,n),this.list=[]}return h(n,[{key:"use",value:function(n,e){f.func(n)&&d.push(this.list,{fn:n,context:e})}},{key:"run",value:function(n,e,t,o){var i=this.list,r=-1,a=function u(a){null==a?(r++,i[r]?i[r].fn.call(i[r].context,n,e,u):t&&t()):o&&o(a)}
a()}}]),n}(),b=function(){function n(e){s(this,n)
var t=this
t.name2Path={},t.path2Route={},t.handleHashChange=t.onHashChange.bind(t)
var o=p,i=o.each,r=o.has,a=n.ROUTE_DEFAULT,u=n.ROUTE_404
return r(e,a)?r(e,u)?void i(e,function(n,e){r(n,"name")&&(t.name2Path[n.name]=e),t.path2Route[e]=n}):void E.error('Route for 404["'+u+'"] is required.'):void E.error('Route for default["'+a+'"] is required.')}return h(n,[{key:"go",value:function(n){if(f.string(n))location.hash=u(n)
else if(f.object(n))if(p.has(n,"component"))this.setComponent(n)
else if(p.has(n,"name")){var e=this.name2Path[n.name]
if(!f.string(e))return void E.error("Name["+n.name+"] of the route is not found.")
location.hash=u(e,n.params,n.query)}}},{key:"onHashChange",value:function(){var e=this,t=e.path2Route,o=location,i=o.hash
i=v.startsWith(i,R)?i.slice(R.length):""
var r=a(t,i)
p.has(r,"path")||(r.path=i?n.ROUTE_404:n.ROUTE_DEFAULT),this.setComponent(r)}},{key:"setComponent",value:function(e){var t=this,o=t.path2Route,i=t.currentRoute,r=t.currentComponent
r||(r={})
var a=r,s=a.options,h=a.instance,f=e.path,l=(e.realpath,e.params),d=e.query,v=e.component,E=e.props,R=void 0
v||(R=o[f],v=R.component)
var O=function(n){n===!1?i&&i.path&&(location.hash=u(i.path,i.params,i.query)):t.go(n)},g=function(n,o,r){var a=new T
a.use(s&&s[n],h),a.use(R&&R[n],R),a.use(t&&t[n],t),a.run(e,i,o,r)},_=function(o){s=o,g(n.HOOK_BEFORE_ENTER,function(){(l||d)&&(E=p.extend({},l,d)),h=new m(p.extend({el:t.el,props:E,extensions:{$router:t}},o)),g(n.HOOK_AFTER_ENTER),t.currentRoute=e,t.currentComponent={options:s,instance:h}},O)},y=function(e){g(n.HOOK_BEFORE_LEAVE,function(){h.destroy(),h=null,g(n.HOOK_AFTER_LEAVE),_(e)},O)}
r.name=v,c.component(v,function(o){v===r.name&&(h?s===o?g(n.HOOK_REFRESHING,function(){y(o)},function(){t.currentRoute=e}):y(o):_(o))})}},{key:"start",value:function(n){this.el=f.string(n)?l.find(n):n,l.on(window,"hashchange",this.handleHashChange),this.handleHashChange()}},{key:"stop",value:function(){this.el=null,l.off(window,"hashchange",this.handleHashChange)}}]),n}()
return b.version="0.20.0",b.ROUTE_DEFAULT="",b.ROUTE_404="*",b.HOOK_REFRESHING="refreshing",b.HOOK_BEFORE_ENTER="beforeEnter",b.HOOK_AFTER_ENTER="afterEnter",b.HOOK_BEFORE_LEAVE="beforeLeave",b.HOOK_AFTER_LEAVE="afterLeave",b.register=function(n,e){c.component(n,e)},b.install=function(n){c=new n({}),m=n,f=n.is,l=n.dom,d=n.array,p=n.object,v=n.string,E=n.logger},"undefined"!=typeof Yox&&Yox.use&&Yox.use(b),b})
