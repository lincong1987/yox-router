!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):n.YoxRouter=t()}(this,function(){"use strict";function n(n){var t={};return h.string(n)&&f.each(n.split(O),function(n){var e=n.split("="),o=c(e,2),r=o[0],i=o[1];r&&(i=!h.string(i)||decodeURIComponent(i),r.endsWith("[]")?(t[r]||(t[r]=[])).push(i):t[r]=i)}),t}function t(n){var t=[];return l.each(n,function(n,e){h.array(n)?f.each(n,function(n){t.push(e+"[]="+encodeURIComponent(n))}):t.push(e+"="+encodeURIComponent(n))}),t.join(O)}function e(n,t){var e={},o=n.split(m),r=t.split(m);return o.length===r.length&&f.each(r,function(n,t){n.startsWith(y)&&(e[n.slice(y.length)]=o[t])}),e}function o(n,t){var e=void 0,o=t.split(m);return l.each(n,function(n,t){var r=t.split(m);if(o.length===r.length&&(f.each(r,function(n,e){if(!n.startsWith(y)&&n!==o[e])return t=null,!1}),t))return e=t,!1}),e}function r(t,r){var i=void 0,a=void 0,u=r.indexOf("?");u>=0?(i=r.substring(0,u),a=r.slice(u+1)):i=r;var s=o(t,i);if(s)return{path:s,realpath:i,params:e(i,s),query:n(a)}}function i(n,e,o){var r=[],i="";return f.each(n.split(m),function(n){r.push(n.startsWith(y)?e[n.slice(y.length)]:n)}),r=r.join(m),o&&(o=t(o),o&&(i="?"+o)),d+r+i}function a(n,t){var e=h,o=e.func,r=e.object,i=b[n];o(i)?!function(){var e=i.$pending;e||(e=i.$pending=[],i(function(t){f.each(e,function(n){n(t)}),b[n]=t})),e.push(t)}():r(i)&&t(i)}var u=(function(){function n(n){this.value=n}function t(t){function e(n,t){return new Promise(function(e,r){var u={key:n,arg:t,resolve:e,reject:r,next:null};a?a=a.next=u:(i=a=u,o(n,t))})}function o(e,i){try{var a=t[e](i),u=a.value;u instanceof n?Promise.resolve(u.value).then(function(n){o("next",n)},function(n){o("throw",n)}):r(a.done?"return":"normal",a.value)}catch(n){r("throw",n)}}function r(n,t){switch(n){case"return":i.resolve({value:t,done:!0});break;case"throw":i.reject(t);break;default:i.resolve({value:t,done:!1})}i=i.next,i?o(i.key,i.arg):a=null}var i,a;this._invoke=e,"function"!=typeof t.return&&(this.return=void 0)}return"function"==typeof Symbol&&Symbol.asyncIterator&&(t.prototype[Symbol.asyncIterator]=function(){return this}),t.prototype.next=function(n){return this._invoke("next",n)},t.prototype.throw=function(n){return this._invoke("throw",n)},t.prototype.return=function(n){return this._invoke("return",n)},{wrap:function(n){return function(){return new t(n.apply(this,arguments))}},await:function(t){return new n(t)}}}(),function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}),s=function(){function n(n,t){for(var e=0;e<t.length;e++){var o=t[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(n,o.key,o)}}return function(t,e,o){return e&&n(t.prototype,e),o&&n(t,o),t}}(),c=function(){function n(n,t){var e=[],o=!0,r=!1,i=void 0;try{for(var a,u=n[Symbol.iterator]();!(o=(a=u.next()).done)&&(e.push(a.value),!t||e.length!==t);o=!0);}catch(n){r=!0,i=n}finally{try{!o&&u.return&&u.return()}finally{if(r)throw i}}return e}return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return n(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),h=void 0,f=void 0,l=void 0,p=void 0,v=void 0,d="#!",y=":",m="/",O="&",E="hashchange",g=function(){function n(){u(this,n),this.list=[]}return s(n,[{key:"use",value:function(n){h.func(n)&&this.list.push(n)}},{key:"run",value:function(n,t,e,o,r){var i=this.list,a=-1,u=function u(s){null==s?(a++,i[a]?i[a].call(n,t,e,u):o&&o()):r&&r(s)};u()}}]),n}(),_=function(){function n(t){u(this,n);var e=this.name2Path={},o=this.path2Route={};this.handleHashChange=this.onHashChange.bind(this),t&&!function(){var n=l,r=n.each,i=n.has;r(t,function(n,t){i(n,"name")&&(e[n.name]=t),o[t]=n})}()}return s(n,[{key:"go",value:function(n){h.string(n)?location.hash=i(n):h.object(n)&&(l.has(n,"component")?this.setComponent(n.component,n.props):l.has(n,"name")&&(location.hash=i(this.name2Path[n.name],n.params,n.query)))}},{key:"onHashChange",value:function(){var t=this,e=t.path2Route,o=location,i=o.hash;i=i.startsWith(d)?i.slice(d.length):"";var a=r(e,i);if(a){var u=a.path,s=a.params,c=a.query;this.setComponent(u,s,c)}else{var h=i?n.HOOK_NOT_FOUND:n.HOOK_INDEX;t[h]&&t[h]()}}},{key:"setComponent",value:function(){var t=this,e=t.path2Route,o=t.componentConfig,r=t.componentInstance,u=arguments,s=void 0,c=void 0,h=void 0,f=void 0,p=void 0,d=void 0;u[2]?(h=u[0],f=u[1],p=u[2],d=e[h],s=d.component):(s=u[0],c=u[1]);var y={component:t.component,props:t.props,path:t.path,params:t.params,query:t.query},m={component:s,props:c,path:h,params:f,query:p},O=function(n){n===!1?y.path&&(location.hash=i(y.path,y.params,y.query)):t.go(n)},E=function(n,e,i){var a=new g;a.use(o&&o[n]),a.use(d&&d[n]),a.use(t&&t[n]),a.run(r,m,y,e,i)},_=function(e){o=e,E(n.HOOK_BEFORE_ENTER,function(){(f||p)&&(c=l.extend({},f,p)),r=new v(l.extend({el:t.el,props:c,extensions:{$router:t}},e)),E(n.HOOK_AFTER_ENTER),l.extend(t,m),t.componentConfig=o,t.componentInstance=r},O)},b=function(t){E(n.HOOK_BEFORE_LEAVE,function(){r.dispose(),r=null,E(n.HOOK_AFTER_LEAVE),_(t)},O)};t.componentName=s,a(s,function(e){s===t.componentName&&(r?o===e?E(n.HOOK_REFRESH,function(){b(e)},function(){l.extend(t,m)}):b(e):_(e))})}},{key:"start",value:function(n){h.string(n)&&(n=p.find(n)),this.el=n,this.handleHashChange(),p.on(window,E,this.handleHashChange)}},{key:"stop",value:function(){this.el=null,p.off(window,E,this.handleHashChange)}}]),n}(),b={};return _.version="0.2.2",_.HOOK_INDEX="index",_.HOOK_NOT_FOUND="notFound",_.HOOK_REFRESH="refresh",_.HOOK_BEFORE_ENTER="beforeEnter",_.HOOK_AFTER_ENTER="afterEnter",_.HOOK_BEFORE_LEAVE="beforeLeave",_.HOOK_AFTER_LEAVE="afterLeave",_.register=function(n,t){h.object(n)?l.extend(b,n):b[n]=t},_.install=function(n){v=n;var t=v,e=t.utils;h=e.is,f=e.array,l=e.object,p=e.native},"undefined"!=typeof Yox&&Yox.use&&Yox.use(_),_});
