!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):n.YoxRouter=e()}(this,function(){"use strict";function n(n){var e={};return l.each(v.parse(n,R,g),function(n){var t=n.key,o=n.value;if(o=h.numeric(o)?+o:!h.string(o)||decodeURIComponent(o),v.endsWith(t,y)){t=t.slice(0,-y.length);var i=e[t]||(e[t]=[]);i.push(o)}else e[t]=o}),e}function e(n,e){var t=[n];return h.string(e)?t.push(encodeURIComponent(e)):h.number(e)?t.push(e):e!==!0&&t.pop(),t.join(g)}function t(n){var t=[];return p.each(n,function(n,o){h.array(n)?l.each(n,function(n){n=e(o+y,n),n&&t.push(n)}):(n=e(o,n),n&&t.push(n))}),t.join(R)}function o(n,e){var t={},o=n.split(O),i=e.split(O);return o.length===i.length&&l.each(i,function(n,e){v.startsWith(n,m)&&(t[n.slice(m.length)]=o[e])}),t}function i(n,e){var t=void 0,o=e.split(O);return p.each(n,function(n,e){var i=e.split(O);if(o.length===i.length&&(l.each(i,function(n,t){if(!v.startsWith(n,m)&&n!==o[t])return e=null,!1}),e))return t=e,!1}),t}function r(e,t){var r=void 0,a=void 0,u=t.indexOf("?");u>=0?(r=t.substring(0,u),a=t.slice(u+1)):r=t;var s={realpath:r},c=i(e,r);return c&&(s.path=c,s.params=o(r,c),s.query=n(a)),s}function a(n,e,o){var i=[],r="";return l.each(n.split(O),function(n){i.push(v.startsWith(n,m)?e[n.slice(m.length)]:n)}),i=i.join(O),o&&(o=t(o),o&&(r="?"+o)),E+i+r}var u=function(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")},s=function(){function n(n,e){for(var t=0;t<e.length;t++){var o=e[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(n,o.key,o)}}return function(e,t,o){return t&&n(e.prototype,t),o&&n(e,o),e}}(),c=void 0,h=void 0,f=void 0,l=void 0,p=void 0,v=void 0,d=void 0,E="#!",m=":",O="/",R="&",g="=",y="[]",_=function(){function n(){u(this,n),this.list=[]}return s(n,[{key:"use",value:function(n,e){h.func(n)&&this.list.push({fn:n,context:e})}},{key:"run",value:function(n,e,t,o){var i=this.list,r=-1,a=function a(u){null==u?(r++,i[r]?i[r].fn.call(i[r].context,n,e,a):t&&t()):o&&o(u)};a()}}]),n}(),T=function(){function n(e){u(this,n);var t=this;t.name2Path={},t.path2Route={},t.handleHashChange=t.onHashChange.bind(t);var o=p,i=o.each,r=o.has,a=n.ROUTE_DEFAULT,s=n.ROUTE_404;return r(e,a)?r(e,s)?void i(e,function(n,e){r(n,"name")&&(t.name2Path[n.name]=e),t.path2Route[e]=n}):void console.error('Route for 404["'+s+'"] is required.'):void console.error('Route for default["'+a+'"] is required.')}return s(n,[{key:"go",value:function(n){if(h.string(n))location.hash=a(n);else if(h.object(n))if(p.has(n,"component"))this.setComponent(n);else if(p.has(n,"name")){var e=this.name2Path[n.name];if(!h.string(e))return void console.error("Name["+n.name+"] of the route is not found.");location.hash=a(e,n.params,n.query)}}},{key:"onHashChange",value:function(){var e=this,t=e.path2Route,o=location,i=o.hash;i=v.startsWith(i,E)?i.slice(E.length):"";var a=r(t,i);p.has(a,"path")||(a.path=i?n.ROUTE_404:n.ROUTE_DEFAULT),this.setComponent(a)}},{key:"setComponent",value:function(e){var t=this,o=t.path2Route,i=t.currentRoute,r=t.currentComponent;r||(r={});var u=r,s=u.options,f=u.instance,l=e.path,v=(e.realpath,e.params),E=e.query,m=e.component,O=e.props,R=void 0;m||(R=o[l],m=R.component);var g=function(n){n===!1?i&&i.path&&(location.hash=a(i.path,i.params,i.query)):t.go(n)},y=function(n,o,r){var a=new _;a.use(s&&s[n],f),a.use(R&&R[n],R),a.use(t&&t[n],t),a.run(e,i,o,r)},T=function(o){s=o,y(n.HOOK_BEFORE_ENTER,function(){(v||E)&&(O=p.extend({},v,E)),O&&h.object(o.propTypes)&&(O=d.validate(O,o.propTypes)),f=new d(p.extend({el:t.el,props:O,extensions:{$router:t}},o)),y(n.HOOK_AFTER_ENTER),t.currentRoute=e,t.currentComponent={options:s,instance:f}},g)},H=function(e){y(n.HOOK_BEFORE_LEAVE,function(){f.destroy(),f=null,y(n.HOOK_AFTER_LEAVE),T(e)},g)};r.name=m,c.component(m,function(o){m===r.name&&(f?s===o?y(n.HOOK_REROUTE,function(){H(o)},function(){t.currentRoute=e}):H(o):T(o))})}},{key:"start",value:function(n){this.el=h.string(n)?f.find(n):n,f.on(window,"hashchange",this.handleHashChange),this.handleHashChange()}},{key:"stop",value:function(){this.el=null,f.off(window,"hashchange",this.handleHashChange)}}]),n}();return T.version="0.15.0",T.ROUTE_DEFAULT="",T.ROUTE_404="*",T.HOOK_REROUTE="reroute",T.HOOK_BEFORE_ENTER="beforeEnter",T.HOOK_AFTER_ENTER="afterEnter",T.HOOK_BEFORE_LEAVE="beforeLeave",T.HOOK_AFTER_LEAVE="afterLeave",T.register=function(n,e){c.component(n,e)},T.install=function(n){c=new n({}),d=n,h=n.is,f=n.dom,l=n.array,p=n.object,v=n.string},"undefined"!=typeof Yox&&Yox.use&&Yox.use(T),T});
