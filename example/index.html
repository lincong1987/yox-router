<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>touch</title>
</head>
<body>
    <div id="app"></div>
    <script src="https://unpkg.com/yox@latest"></script>
    <script src="../dist/yox-router.js"></script>
    <script>
        Yox.use(YoxRouter)

        YoxRouter.register({
          index: {
            template: `
              <div>
                <h1>index</h1>
                <button on-click="register()">
                  register
                </button>
                {{stringify(this)}}
              </div>
            `,
            methods: {
              register: function () {
                this.route({
                  name: 'register',
                  query: { age: 10 }
                })
              }
            }
          },
          register: {
            template: `
              <div>
                <h1>register</h1>
                <button on-click="login()">
                  login
                </button>
                {{stringify(this)}}
              </div>
            `,
            methods: {
              login: function () {
                this.route('/login')
              }
            }
          },
          login: function (resolve) {
            setTimeout(
              function () {
                resolve({
                  template: `
                    <div>
                      <h1>login</h1>
                      <button on-click="index()">
                        index
                      </button>
                      {{stringify(this)}}
                    </div>
                  `,
                  events: {
                    refreshcomponent: function (data) {
                      console.log('refreshcomponent', data)
                    }
                  },
                  methods: {
                    index: function () {
                      this.route({
                        name: 'login',
                        query: {
                          name: 'musicode'
                        }
                      })
                    }
                  }
                })
              },
              1000
            )
          },
          profile: {
            template: `
              <div>
                <h1>profile</h1>
                {{stringify(this)}}
              </div>
            `,
          }
        })

        YoxRouter.map({
          '/index': {
            component: 'index'
          },
          '/register': {
            name: 'register',
            component: 'register'
          },
          '/login': {
            name: 'login',
            component: 'login'
          },
          '/profile/:id': {
            name: 'profile',
            component: 'profile'
          }
        })

        Yox.filter('stringify', function (data) {
          return JSON.stringify(data)
        })

        YoxRouter.start(document.getElementById('app'))

    </script>
</body>
</html>
